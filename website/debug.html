<!DOCTYPE html>
<html>
<head>
    <title>Debug Page</title>
    <style>
        body { background: #0d1117; color: #c9d1d9; font-family: monospace; padding: 20px; }
        .ok { color: #3fb950; }
        .error { color: #f85149; }
        .info { color: #58a6ff; }
        img { max-width: 500px; border: 2px solid #30363d; margin: 10px 0; }
        button { background: #21262d; color: #c9d1d9; border: 1px solid #30363d; padding: 8px 16px; margin: 5px; cursor: pointer; }
        button:hover { background: #30363d; }
        #log { background: #161b22; padding: 15px; border-radius: 6px; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>ðŸ”¬ GIF Debug Page</h1>
    <div id="log"></div>
    <hr>
    <h3>Select a drug:</h3>
    <div id="drug-buttons"></div>
    <hr>
    <h3>Receptor GIFs:</h3>
    <div id="receptor-buttons"></div>
    <hr>
    <div id="gif-container">
        <img id="gif-img" src="" style="display:none">
        <p id="gif-path"></p>
    </div>

    <script src="gif_index.js"></script>
    <script>
        const log = document.getElementById('log');
        function addLog(msg, type='info') {
            const span = document.createElement('div');
            span.className = type;
            span.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            log.appendChild(span);
            log.scrollTop = log.scrollHeight;
        }

        // Check GIF_INDEX
        if (typeof GIF_INDEX === 'undefined') {
            addLog('ERROR: GIF_INDEX is undefined!', 'error');
        } else {
            const count = Object.keys(GIF_INDEX).length;
            addLog(`GIF_INDEX loaded: ${count} drugs`, 'ok');
            
            // Show some drug buttons
            const drugs = ['DMT', 'LSD', 'MDMA', 'Psilocin', 'Ketamine', 'Cannabis', 'Mescaline', '2C-B'];
            const drugBtns = document.getElementById('drug-buttons');
            
            drugs.forEach(drug => {
                const btn = document.createElement('button');
                btn.textContent = drug;
                if (GIF_INDEX[drug]) {
                    btn.onclick = () => showDrug(drug);
                    addLog(`  ${drug}: ${GIF_INDEX[drug].length} GIFs`, 'ok');
                } else {
                    btn.disabled = true;
                    btn.style.opacity = 0.5;
                    addLog(`  ${drug}: NOT FOUND`, 'error');
                }
                drugBtns.appendChild(btn);
            });
        }

        function showDrug(name) {
            addLog(`Selected: ${name}`, 'info');
            const gifs = GIF_INDEX[name];
            const receptorBtns = document.getElementById('receptor-buttons');
            receptorBtns.innerHTML = '';
            
            gifs.forEach((g, i) => {
                const btn = document.createElement('button');
                btn.textContent = g.receptor;
                btn.onclick = () => showGif(g);
                receptorBtns.appendChild(btn);
                
                if (i === 0) showGif(g);
            });
        }

        function showGif(g) {
            const img = document.getElementById('gif-img');
            const path = document.getElementById('gif-path');
            const gifPath = 'animations/' + g.file;
            
            addLog(`Loading: ${gifPath}`, 'info');
            img.style.display = 'none';
            img.onload = () => {
                img.style.display = 'block';
                addLog(`Loaded successfully!`, 'ok');
            };
            img.onerror = () => {
                addLog(`FAILED to load: ${gifPath}`, 'error');
            };
            img.src = gifPath;
            path.textContent = gifPath;
        }
    </script>
</body>
</html>
